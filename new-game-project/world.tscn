[gd_scene load_steps=10 format=4 uid="uid://e27tcmwbd3ke"]

[ext_resource type="Script" path="res://world.gd" id="1_novwx"]
[ext_resource type="PackedScene" uid="uid://u84grsd473oa" path="res://scenes/map_looper.tscn" id="2_64qo5"]
[ext_resource type="TileSet" uid="uid://duauvrqv8jk" path="res://map_tileset.tres" id="2_rda4a"]
[ext_resource type="PackedScene" uid="uid://dp122pt878tim" path="res://scenes/player.tscn" id="3_e5w51"]
[ext_resource type="PackedScene" uid="uid://c3ivuprkcunht" path="res://scenes/hud.tscn" id="4_bkgi5"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_xq13f"]
size = Vector2(32, 640)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_w4o25"]
size = Vector2(32, 640)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_aflty"]
size = Vector2(288, 32)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_hgluf"]
size = Vector2(278, 116)

[node name="World" type="Node2D"]
script = ExtResource("1_novwx")

[node name="MapLooper" parent="." instance=ExtResource("2_64qo5")]

[node name="board" type="TileMapLayer" parent="."]
visible = false
use_parent_material = true
tile_map_data = PackedByteArray("AAAAAAEAZwALAAAAAAAAAAIAZwALAAAAAAAAAAMAZwALAAAAAAAAAAQAZwALAAAAAAAAAAUAZwALAAAAAAAAAAYAZwALAAAAAAAAAAcAZwALAAAAAAAAAAgAZwALAAAAAAAAAAkAZwALAAAAAAAAAAoAZwALAAAAAAAAAAsAZwALAAAAAAAAAAwAZwALAAAAAAAAAA0AZwALAAAAAAAAAA4AZwALAAAAAAAAAA8AZwALAAAAAAAAABAAZwALAAAAAAAAABEAZwALAAAAAAAAABIAZwALAAAAAAAAABMAZwALAAAAAAABABMAZwALAAAAAAACABMAZwALAAAAAAADABMAZwALAAAAAAAEABMAZwALAAAAAAAFABMAZwALAAAAAAAGABMAZwALAAAAAAAHABMAZwALAAAAAAAIABMAZwALAAAAAAAJABMAZwALAAAAAAAAAAAAZwALAAAAAAAKABMAZwALAAAAAAAKABIAZwALAAAAAAAKABEAZwALAAAAAAAKABAAZwALAAAAAAAKAA8AZwALAAAAAAAKAA4AZwALAAAAAAAKAA0AZwALAAAAAAAKAAwAZwALAAAAAAAKAAsAZwALAAAAAAAKAAoAZwALAAAAAAAKAAkAZwALAAAAAAAKAAgAZwALAAAAAAAKAAcAZwALAAAAAAAKAAYAZwALAAAAAAAKAAUAZwALAAAAAAAKAAQAZwALAAAAAAAKAAMAZwALAAAAAAAKAAIAZwALAAAAAAAKAAEAZwALAAAAAAAKAAAAZwALAAAAAAA=")
tile_set = ExtResource("2_rda4a")
rendering_quadrant_size = 64

[node name="active" type="TileMapLayer" parent="."]
visible = false
use_parent_material = true
tile_set = ExtResource("2_rda4a")

[node name="blockSpawner" type="Marker2D" parent="."]
position = Vector2(173, 0)

[node name="spawnTimer" type="Timer" parent="."]
autostart = true

[node name="blockManager" type="Node2D" parent="."]

[node name="walls" type="StaticBody2D" parent="."]
visible = false
collision_layer = 3

[node name="leftWall" type="CollisionShape2D" parent="walls"]
position = Vector2(16, 320)
shape = SubResource("RectangleShape2D_xq13f")
disabled = true

[node name="rightWall" type="CollisionShape2D" parent="walls"]
position = Vector2(336, 320)
shape = SubResource("RectangleShape2D_w4o25")
disabled = true

[node name="floor" type="StaticBody2D" parent="."]
visible = false
position = Vector2(0, 1)
collision_layer = 3
collision_mask = 3

[node name="floor" type="CollisionShape2D" parent="floor"]
position = Vector2(176, 624)
shape = SubResource("RectangleShape2D_aflty")
disabled = true

[node name="spawnArea" type="Area2D" parent="."]

[node name="CollisionShape2D" type="CollisionShape2D" parent="spawnArea"]
position = Vector2(176, 48)
shape = SubResource("RectangleShape2D_hgluf")

[node name="Player" parent="." instance=ExtResource("3_e5w51")]
position = Vector2(56, 600)

[node name="HUD" parent="." instance=ExtResource("4_bkgi5")]

[connection signal="game_over" from="." to="MapLooper" method="deActivate"]
[connection signal="game_over" from="." to="HUD" method="game_over"]
[connection signal="piece_placed" from="." to="MapLooper" method="add_piece"]
[connection signal="timeout" from="spawnTimer" to="." method="_on_spawn_timer_timeout"]
[connection signal="body_entered" from="spawnArea" to="." method="_on_spawn_area_body_entered"]
[connection signal="body_exited" from="spawnArea" to="." method="_on_spawn_area_body_exited"]
[connection signal="die" from="Player" to="." method="_on_player_die"]
